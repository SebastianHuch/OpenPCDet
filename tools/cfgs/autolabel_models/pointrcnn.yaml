CLASS_NAMES:
- Car
- Pedestrian
- Cyclist
DATA_CONFIG:
  DATA_PROCESSOR:
  - NAME: mask_points_and_boxes_outside_range
    REMOVE_OUTSIDE_BOXES: true
  - NAME: sample_points
    NUM_POINTS:
      test: 16384
      train: 16384
      val: 16384
  - NAME: shuffle_points
    SHUFFLE_ENABLED:
      test: false
      train: true
      val: false
  _BASE_CONFIG_: /home/tools/cfgs/dataset_configs/autolabel_dataset.yaml
MODEL:
  BACKBONE_3D:
    FP_MLPS:
    - - 128
      - 128
    - - 256
      - 256
    - - 512
      - 512
    - - 512
      - 512
    NAME: PointNet2MSG
    SA_CONFIG:
      MLPS:
      - - - 16
          - 16
          - 32
        - - 32
          - 32
          - 64
      - - - 64
          - 64
          - 128
        - - 64
          - 96
          - 128
      - - - 128
          - 196
          - 256
        - - 128
          - 196
          - 256
      - - - 256
          - 256
          - 512
        - - 256
          - 384
          - 512
      NPOINTS:
      - 4096
      - 1024
      - 256
      - 64
      NSAMPLE:
      - - 16
        - 32
      - - 16
        - 32
      - - 16
        - 32
      - - 16
        - 32
      RADIUS:
      - - 0.1
        - 0.5
      - - 0.5
        - 1.0
      - - 1.0
        - 2.0
      - - 2.0
        - 4.0
  NAME: PointRCNN
  POINT_HEAD:
    CLASS_AGNOSTIC: false
    CLS_FC:
    - 256
    - 256
    LOSS_CONFIG:
      LOSS_REG: WeightedSmoothL1Loss
      LOSS_WEIGHTS:
        code_weights:
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        point_box_weight: 1.0
        point_cls_weight: 1.0
    NAME: PointHeadBox
    REG_FC:
    - 256
    - 256
    TARGET_CONFIG:
      BOX_CODER: PointResidualCoder
      BOX_CODER_CONFIG:
        mean_size:
        - - 3.92
          - 1.63
          - 1.53
        - - 0.8
          - 0.6
          - 1.73
        - - 1.76
          - 0.6
          - 1.73
        use_mean_size: true
      GT_EXTRA_WIDTH:
      - 0.2
      - 0.2
      - 0.2
    USE_POINT_FEATURES_BEFORE_FUSION: false
  POST_PROCESSING:
    EVAL_METRIC: kitti
    NMS_CONFIG:
      MULTI_CLASSES_NMS: false
      NMS_POST_MAXSIZE: 500
      NMS_PRE_MAXSIZE: 4096
      NMS_THRESH: 0.1
      NMS_TYPE: nms_gpu
    OUTPUT_RAW_SCORE: false
    RECALL_THRESH_LIST:
    - 0.3
    - 0.5
    - 0.7
    SCORE_THRESH: 0.1
  ROI_HEAD:
    CLASS_AGNOSTIC: true
    CLS_FC:
    - 256
    - 256
    DP_RATIO: 0.0
    LOSS_CONFIG:
      CLS_LOSS: BinaryCrossEntropy
      CORNER_LOSS_REGULARIZATION: true
      LOSS_WEIGHTS:
        code_weights:
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        - 1.0
        rcnn_cls_weight: 1.0
        rcnn_corner_weight: 1.0
        rcnn_reg_weight: 1.0
      REG_LOSS: smooth-l1
    NAME: PointRCNNHead
    NMS_CONFIG:
      TEST:
        MULTI_CLASSES_NMS: false
        NMS_POST_MAXSIZE: 100
        NMS_PRE_MAXSIZE: 9000
        NMS_THRESH: 0.85
        NMS_TYPE: nms_gpu
      TRAIN:
        MULTI_CLASSES_NMS: false
        NMS_POST_MAXSIZE: 512
        NMS_PRE_MAXSIZE: 9000
        NMS_THRESH: 0.8
        NMS_TYPE: nms_gpu
      VAL:
        MULTI_CLASSES_NMS: false
        NMS_POST_MAXSIZE: 100
        NMS_PRE_MAXSIZE: 9000
        NMS_THRESH: 0.85
        NMS_TYPE: nms_gpu
    REG_FC:
    - 256
    - 256
    ROI_POINT_POOL:
      DEPTH_NORMALIZER: 70.0
      NUM_SAMPLED_POINTS: 512
      POOL_EXTRA_WIDTH:
      - 0.0
      - 0.0
      - 0.0
    SA_CONFIG:
      MLPS:
      - - 128
        - 128
        - 128
      - - 128
        - 128
        - 256
      - - 256
        - 256
        - 512
      NPOINTS:
      - 128
      - 32
      - -1
      NSAMPLE:
      - 16
      - 16
      - 16
      RADIUS:
      - 0.2
      - 0.4
      - 100
    TARGET_CONFIG:
      BOX_CODER: ResidualCoder
      CLS_BG_THRESH: 0.45
      CLS_BG_THRESH_LO: 0.1
      CLS_FG_THRESH: 0.6
      CLS_SCORE_TYPE: cls
      FG_RATIO: 0.5
      HARD_BG_RATIO: 0.8
      REG_FG_THRESH: 0.55
      ROI_PER_IMAGE: 128
      SAMPLE_ROI_BY_EACH_CLASS: true
    USE_BN: false
    XYZ_UP_LAYER:
    - 128
    - 128
OPTIMIZATION:
  BATCH_SIZE_PER_GPU: 6
  DECAY_STEP_LIST:
  - 35
  - 45
  DIV_FACTOR: 10
  EVAL_MIN_EPOCH: 59
  EVAL_RATE: 4
  GRAD_NORM_CLIP: 10
  LR: 0.01
  LR_CLIP: 1.0e-07
  LR_DECAY: 0.1
  LR_WARMUP: false
  MOMENTUM: 0.9
  MOMS:
  - 0.95
  - 0.85
  NUM_EPOCHS: 75
  OPTIMIZER: adam_onecycle
  PCT_START: 0.4
  WARMUP_EPOCH: 1
  WEIGHT_DECAY: 0.01
