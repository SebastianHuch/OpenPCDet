# FILE DESCRIPTION:
# This file serves as a centralized configuration file for the autolabel pipeline.
# Parameters are divided as follows:
#   DATA: -> Paths to the data.
#   VISUALIZATION: -> parameters for visualization with open3d
#   PIPELINE: -> parameters for the auto-labeling pipeline



DATA:
  PROJECT:
    MODELS: [ "pointrcnn", "pointpillar", "second" ]

    CFG_DATASET: "tools/cfgs/dataset_configs/autolabel_dataset.yaml"
    CFG_MODELS: "tools/cfgs/autolabel_models"

    DATASET: "data/autolabel"
    AUTOLABEL_DATA: "autolabel_data/autolabel"


  # Paths to point clouds / ground truths
  # Path to frame predictions
  # Path to pseudo_labels
  PATH_POINT_CLOUDS: "/home/data/autolabel/training/velodyne"
  PATH_GROUND_TRUTHS: "/home/data/autolabel/training/label_2"

  PATH_PTRCNN_PREDICTIONS: "/home/autolabel_data/autolabel/predictions/pointrcnn"
  PATH_PTPILLAR_PREDICTIONS: "/home/autolabel_data/autolabel/predictions/pointpillar"
  PATH_SECOND_PREDICTIONS: "/home/autolabel_data/autolabel/predictions/second"

  PATH_PSEUDO_LABELS:
    PSEUDO_LABELS_MAJORITY: "/home/autolabel_data/autolabel/predictions/pseudo_labels/majority_voting"
    PSEUDO_LABELS_NMS: "/home/autolabel_data/autolabel/predictions/pseudo_labels/nms_voting"



PIPELINE:
  # VOTING_SCHEME: 'MAJORITY' or 'NMS'
  VOTING_SCHEME: 'MAJORITY'
  SHOW_POINT_CLOUDS: False
  PRINT_INFORMATION: True

  CLASSES: ['Car', 'Pedestrian', 'Cyclist']


  # Voting scheme nms voting.
  NMS_VOTING:
    THRESHOLDS:
      THRESHOLD_NMS_OVERLAP: 0.4  # 0.5 taken from PTRCNN at inference

      THRESHOLD_CONFIDENCE_CAR: 0.95
      THRESHOLD_CONFIDENCE_CYCLIST: 0.8
      THRESHOLD_CONFIDENCE_PEDESTRIAN: 0.9


  # Voting scheme majority voting.
  MAJORITY_VOTING:
    SAVE_HIGHLY_UNCERTAIN_LABELS_SEPARATELY: True

    THRESHOLDS:
      THRESHOLD_IOU: 0.4            # minimum iou of two objects to be regarded as one set. In %
      THRESHOLD_HEADING: 30         # degrees

      THRESHOLD_3_BBOXES:
        CONFIDENCE_CAR: 0.85
        CONFIDENCE_CYCLIST: 0.65
        CONFIDENCE_PEDESTRIAN: 0.65

      THRESHOLD_2_BBOXES:
        CONFIDENCE_CAR: 0.9
        CONFIDENCE_CYCLIST: 0.75
        CONFIDENCE_PEDESTRIAN: 0.75

      THRESHOLD_1_BBOX:
        CONFIDENCE_CAR: 1
        CONFIDENCE_CYCLIST: 1
        CONFIDENCE_PEDESTRIAN: 1



VISUALISATION:
  # Options: ['groundtruths', 'pointrcnn', 'pointpillar', 'second', 'pseudo_labels']
  # Select ID of a specific point cloud to visualize. If : '' -> 5 randomly selected point clouds will be visualized.
  BBOXES_TO_LOAD: ['pointrcnn', 'pointpillar', 'second']
  POINT_CLOUD_ID_TO_VISUALIZE: '000135'