

# FILE DESCRIPTION:

# This file serves as a centralized configuration file for the autolabel pipeline.
# Parameters are explained below:
#
#DATA:
#--Data paths.
#  PROJECT:
#  --Specify paths to a project and trigger autolabel pipeline
#    DATASET: "data/autolabel"
#    --Path to the manually labeled dataset.
#    AUTOLABEL_DATA: "autolabel_data/autolabel"
#    --Path to pred./ pseudo- generated by autolabel_pipeline.
#    MODELS: [ "pointrcnn", "pointpillar", "second" ]
#    --Pipeline set up to work with: ["pointrcnn", "pointpillar", "second"]. Do not change.
#    CFG_DATASET: "tools/cfgs/dataset_configs/autolabel_dataset.yaml"
#    --Path to dataset config
#    CFG_MODELS: "tools/cfgs/autolabel_models"
#    --Path to folder with model configs
#  PATH_POINT_CLOUDS: "/home/data/autolabel/training/velodyne"
#  --Path to point cloud files
#  PATH_GROUND_TRUTHS: "/home/data/autolabel/training/label_2"
#  --Path to ground truth labels
#
#PIPELINE:
#-- Parameters necessary to the autolabel pipeline
#  VOTING_SCHEME: 'MAJORITY'
#  --Define the voting scheme used in the pipeline: 'MAJORITY' or 'NMS'
#  SHOW_POINT_CLOUDS: True
#  --For every frame, show the point clouds. Boolean.
#  PRINT_INFORMATION: True
#  --Print additional information during inference time of the pipeline.
#  CLASSES: ['Car', 'Pedestrian', 'Cyclist']
#  --Classes to generate pseudo-labels for.
#  NMS_VOTING:
#   --Voting scheme nms voting. Below are the configurable parameters for NMS voting
#    THRESHOLDS:
#     --All Thresholds for NMS
#      THRESHOLD_NMS_OVERLAP: 0.4
#      --Minimum overlap for two bboxes to be treated as one set for NMS step. --> 0.5 PTRCNN at inference
#      THRESHOLD_CONFIDENCE_CAR: 0.95
#      --Min. confidence threshold a car bbox must have to be kept as pseudo-label after NMS step.
#      THRESHOLD_CONFIDENCE_CYCLIST: 0.8
#      --Min. confidence threshold a cyclist bbox must have to be kept as pseudo-label after NMS step.
#      THRESHOLD_CONFIDENCE_PEDESTRIAN: 0.9
#      --Min. confidence threshold a pedestrian bbox must have to be kept as pseudo-label after NMS step.
#  MAJORITY_VOTING:
#  --Voting scheme majority voting. Below are the configurable parameters for MAJORITY voting
#    SAVE_HIGHLY_UNCERTAIN_LABELS_SEPARATELY: True
#     -- If a pseudo-labels likelihood of being TP is not decidable, save it in a separate control/ folder. Boolean
#    THRESHOLDS:
#    --All Thresholds for MAJORITY
#      THRESHOLD_IOU: 0.4
#      --minimum iou of two objects to be regarded as one set describing the same object. Defined as % ratio.
#      THRESHOLD_HEADING: 30
#      --maximum heading difference between two bounding boxes to be regarded as similar. Defined in degrees.
#      THRESHOLD_3_BBOXES:
#      --Confidence values necessary to keep a pseudo-label (3 bbox set). Average confidence over the bboxes in question.
#        CONFIDENCE_CAR: 0.85
#        --Min. confidence threshold a 3 car bbox group must have to be kept as pseudo-label.
#        CONFIDENCE_CYCLIST: 0.65
#        --Min. confidence threshold a 3 cyclist bbox group must have to be kept as pseudo-label.
#        CONFIDENCE_PEDESTRIAN: 0.65
#        --Min. confidence threshold a 3 pedestrian bbox group must have to be kept as pseudo-label.
#      THRESHOLD_2_BBOXES:
#      --Confidence values necessary to keep a pseudo-label (2 bbox set). Average confidence over the bboxes in question.
#        CONFIDENCE_CAR: 0.9
#        --Min. confidence threshold a 2 car bbox group must have to be kept as pseudo-label.
#        CONFIDENCE_CYCLIST: 0.75
#        --Min. confidence threshold a 2 cyclist bbox group must have to be kept as pseudo-label.
#        CONFIDENCE_PEDESTRIAN: 0.75
#        --Min. confidence threshold a 2 pedestrian bbox group must have to be kept as pseudo-label.
#      THRESHOLD_1_BBOX:
#      --Confidence values necessary to keep a pseudo-label (1 bbox set). Average confidence over the bboxes in question.
#        CONFIDENCE_CAR: 1
#        --Min. confidence threshold a car bbox must have to be kept as pseudo-label.
#        CONFIDENCE_CYCLIST: 1
#        --Min. confidence threshold a cyclist bbox must have to be kept as pseudo-label.
#        CONFIDENCE_PEDESTRIAN: 1
#        --Min. confidence threshold a pedestrian bbox must have to be kept as pseudo-label.
#
#VISUALISATION:
#--Parameters concerning only the visualisation of point clouds/ labels.
#  BBOXES_TO_LOAD: ['pseudo_labels']
#  --Defines the type of boxes to be loaded for a point cloud frame. Options: ['groundtruths', 'pointrcnn', 'pointpillar', 'second', 'pseudo_labels']
#  POINT_CLOUD_ID_TO_VISUALIZE: '000135'
#  --Select a specific frame to be loaded when triggering visualize_pcd directly. If : '' -> 5 randomly selected point clouds will be visualized.



DATA:

  # EDGAR
  PATH_POINT_CLOUDS: "/home/data/autolabel_EDGAR/training/velodyne"     # EDGAR
  PATH_GROUND_TRUTHS: "/home/data/autolabel_EDGAR/training/label_2"     # EDGAR

  # KITTI
  #PATH_POINT_CLOUDS: "/home/data/autolabel_kitti/training/velodyne"    # KITTI
  #PATH_GROUND_TRUTHS: "/home/data/autolabel_kitti/original/label_2"    # KITTI

  # WAYMO
  #PATH_POINT_CLOUDS: "/home/data/waymo_og/training/velodyne"           # Waymo
  #PATH_GROUND_TRUTHS: "/home/data/waymo_og/training/label_2"           # Waymo



  PROJECT:

    # EDGAR
    DATASET: "data/autolabel_EDGAR"                                     # EDGAR
    AUTOLABEL_DATA: "autolabel_data/autolabel_EDGAR"                    # EDGAR

    # KITTI
    #DATASET: "data/autolabel_kitti"                                    # KITTI
    #AUTOLABEL_DATA: "autolabel_data/autolabel_kitti"                   # KITTI

    # Waymo
    #DATASET: "data/autolabel_waymo"                                    # Waymo
    #AUTOLABEL_DATA: "autolabel_data/autolabel_waymo_nms"               # Waymo


    CFG_DATASET: "tools/cfgs/dataset_configs/autolabel_dataset.yaml"
    CFG_MODELS: "tools/cfgs/autolabel_models"
    MODELS: ["pointrcnn", "pointpillar", "second"]



PIPELINE:
  SHOW_POINT_CLOUDS: False
  PRINT_INFORMATION: False
  COMPUTE_EVALUATION_METRICS: True
  VOTING_SCHEME: 'MAJORITY'
  CLASSES: [ 'Car', 'Pedestrian', 'Cyclist' ]

  NMS_VOTING:
    THRESHOLDS:
      THRESHOLD_NMS_OVERLAP: 0.4
      THRESHOLD_CONFIDENCE_CAR: 0.55      #0.85
      THRESHOLD_CONFIDENCE_CYCLIST: 0.55    #0.85
      THRESHOLD_CONFIDENCE_PEDESTRIAN: 0.55   #0.85

  MAJORITY_VOTING:
    SAVE_HIGHLY_UNCERTAIN_LABELS_SEPARATELY: True
    THRESHOLDS:
      THRESHOLD_IOU: 0.4
      THRESHOLD_HEADING: 30
      THRESHOLD_3_BBOXES:
        CONFIDENCE_CAR: 0.7
        CONFIDENCE_CYCLIST: 0.7
        CONFIDENCE_PEDESTRIAN: 0.7
      THRESHOLD_2_BBOXES:
        CONFIDENCE_CAR: 0.8
        CONFIDENCE_CYCLIST: 0.8
        CONFIDENCE_PEDESTRIAN: 0.8
      THRESHOLD_1_BBOX:
        CONFIDENCE_CAR: 0.9
        CONFIDENCE_CYCLIST: 0.9
        CONFIDENCE_PEDESTRIAN: 0.9



VISUALISATION:
  #BBOXES_TO_LOAD: ['pointrcnn', 'pointpillar', 'second']
  BBOXES_TO_LOAD: ["pseudo_labels"]
  POINT_CLOUD_ID_TO_VISUALIZE: '001088'
